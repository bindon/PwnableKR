from pwn import *

# connect
proc = remote("pwnable.kr", 9007)

# receive notice
print proc.recv(timeout=3)

for _ in range(100):
    # receive N, C
    values = dict(element.split("=") for element in proc.recvline().split())

    minN=0
    maxN=int(values['N'])

    for _ in range(int(values['C'])):
        midN = (maxN+minN) >> 1

        print "[*] Inpect {minN}, {maxN}".format(minN=minN, maxN=maxN)

        payload = ""
        for idx in range(minN, midN+1):
            payload += str(idx) + " "

        if payload.__len__() == 0:
            payload = str(maxN)

        proc.sendline(payload.strip())
        
        readline = proc.recvline()
        if readline.strip() == "9":
            maxN = minN
            break 
        if readline[-2] == "0":
            minN = midN
        elif readline[-2] == "9":
            maxN = midN

    proc.sendline(str(maxN))
    print proc.recv()

print proc.recv()

# disconnect
proc.close()
